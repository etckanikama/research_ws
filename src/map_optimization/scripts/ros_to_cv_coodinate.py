import cv2
import numpy as np


# create_white_map_opencv.py用のフォーマットに変換
# 画像のサイズを指定
width  = 662
height = 1263 
# Max_Y_cv = 1263
# Max_X_cv = 662

# 画像を生成して茶色っぽい色で塗りつぶす
image = np.full((height, width, 3), (65, 105, 225), dtype=np.uint8)


# cvから見たros座標原点(x0,y0)
x0_cv = 301
y0_cv = 1263
# y0_cv = 6100


corner_num = 4
# polygon_num = 10
# polygon_num = 5

# sb_mapの入力のros座標系([x_ros,y_ros])単位はセンチ
polygon_ros = { 0: [[912.5, 54.5], [912.5, 47.0], [0.0, 47.0], [0.0, 54.5]],
1: [[912.5, 193.5], [912.5, 54.5], [905.0, 54.5], [905.5, 193.5]],
2: [[1020.5, 193.5], [1020.5, 186.0], [912.5, 186.0], [912.5, 193.5]],
3: [[1020.5, 301.0], [1020.5, 193.5], [1013.0, 193.5], [1013.0, 301.0]],
4: [[1135.5, 301.0], [1135.5, 176.0], [1128.0, 176.0], [1128.0, 301.0]],
5: [[1263.0, 183.5], [1263.0, 176.0], [1135.5, 176.0], [1135.5, 183.5]],
6: [[1263.0, 82.0], [1263.0, 75.0], [1141.0, 75.0], [1141.0, 82.0]],
7: [[1148.5, 75.0], [1148.5, -361.0], [1141.0, -361.0], [1141.0, 75.0]],
8: [[1009.5, -54.5], [1009.5, -361.0], [1002.0, -361.0], [1002.0, -54.5]],
9: [[1009.5, -47.0], [1009.5, -54.5], [0.0, -54.5], [0.0, -47.0]],
10: [[54.5, -146.5], [54.5, -361.0], [47.0, -361.0], [47.0, -146.5]],
11: [[134.5, -146.5], [134.5, -154.0], [54.5, -154.0], [54.5, -146.5]],
12: [[142.0, -146.5], [142.0, -361.0], [134.5, -361.0], [134.5, -146.5]],
13: [[232.5, -146.5], [232.5, -361.0], [225.0, -361.0], [225.0, -146.5]],
14: [[326.0, -146.5], [326.0, -154.0], [232.5, -154.0], [232.5, -146.5]],
15: [[333.5, -146.5], [333.5, -361.0], [326.0, -361.0], [326.0, -146.5]],
16: [[422.5, -146.5], [422.5, -361.0], [415.0, -361.0], [415.0, -146.5]],
17: [[517.5, -146.5], [517.5, -154.0], [422.5, -154.0], [422.5, -146.5]],
18: [[525.0, -146.5], [525.0, -361.0], [517.5, -361.0], [517.5, -146.5]],
19: [[612.5, -146.5], [612.5, -361.0], [605.0, -361.0], [605.0, -146.5]],
20: [[708.5, -146.5], [708.5, -154.0], [612.5, -154.0], [612.5, -146.5]],
21: [[716.0, -146.5], [716.0, -361.0], [708.0, -361.0], [708.0, -146.5]],
22: [[803.5, -146.5], [803.5, -361.0], [796.0, -361.0], [796.0, -146.5]],
23: [[930.5, -146.5], [930.5, -154.0], [805.5, -154.0], [805.5, -146.5]],
24: [[938.0, -146.5], [938.0, -361.0], [930.5, -361.0], [930.5, -146.5]],
# # ひげの候補地？？route1
# 25: [[876.1401098901098, 80.75000000000001], [876.1401098901098, 20.750000000000007], [868.6401098901099, 20.750000000000007], [868.6401098901099, 80.75000000000001]],
# 26: [[725.728021978022, 80.75000000000001], [725.728021978022, 20.750000000000007], [718.2280219780221, 20.750000000000007], [718.2280219780221, 80.75000000000001]],
# 27: [[324.6291208791209, 80.75000000000001], [324.6291208791209, 20.750000000000007], [317.1291208791209, 20.750000000000007], [317.1291208791209, 80.75000000000001]],
# 28: [[579.165, -20.750000000000007], [579.165, -80.75000000000001], [571.6650000000001, -80.75000000000001], [571.6650000000001, -20.750000000000007]],
# 29: [[437.8349999999999, -20.750000000000007], [437.8349999999999, -80.75000000000001], [430.335, -80.75000000000001], [430.335, -20.750000000000007]],
# 30: [[235.93500000000006, -20.750000000000007], [235.93500000000006, -80.75000000000001], [228.43500000000003, -80.75000000000001], [228.43500000000003, -20.750000000000007]],
# 31: [[1174.75, 18.05232558139536], [1174.75, 10.552325581395358], [1114.75, 10.552325581395358], [1114.75, 18.05232558139536]],
# 32: [[1035.7500000000002, -244.23333333333335], [1035.7500000000002, -251.73333333333338], [975.75, -251.73333333333338], [975.75, -244.23333333333335]],
# 33: [[1035.7500000000002, -356.25], [1035.7500000000002, -363.75], [975.75, -363.75], [975.75, -356.25]],

# # ひげの候補地？？route1の逆走
# 25: [[846.0576923076923, 80.75000000000001], [846.0576923076923, 20.750000000000007], [838.5576923076924, 20.750000000000007], [838.5576923076924, 80.75000000000001]],
# 26: [[715.7005494505494, 80.75000000000001], [715.7005494505494, 20.750000000000007], [708.2005494505495, 20.750000000000007], [708.2005494505495, 80.75000000000001]],
# 27: [[575.3159340659341, 80.75000000000001], [575.3159340659341, 20.750000000000007], [567.8159340659341, 20.750000000000007], [567.8159340659341, 80.75000000000001]],
# 28: [[444.9587912087912, 80.75000000000001], [444.9587912087912, 20.750000000000007], [437.4587912087913, 20.750000000000007], [437.4587912087913, 80.75000000000001]],
# 29: [[144.13461538461542, 80.75000000000001], [144.13461538461542, 20.750000000000007], [136.63461538461542, 20.750000000000007], [136.63461538461542, 80.75000000000001]],
# 30: [[3.75, 80.75000000000001], [3.75, 20.750000000000007], [-3.75, 20.750000000000007], [-3.75, 80.75000000000001]],
# 31: [[948.65, 219.74999999999997], [948.65, 159.75], [941.15, 159.75], [941.15, 219.74999999999997]],
# 32: [[286.41, -20.750000000000007], [286.41, -80.75000000000001], [278.90999999999997, -80.75000000000001], [278.90999999999997, -20.750000000000007]],
# 33: [[1174.75, 7.936046511627917], [1174.75, 0.43604651162791674], [1114.75, 0.43604651162791674], [1114.75, 7.936046511627917]],
# 34: [[1174.75, -93.22674418604649], [1174.75, -100.7267441860465], [1114.75, -100.7267441860465], [1114.75, -93.22674418604649]],

# ルート1 &ルート1逆走の両方を入力したときの被覆問題で解いたポリゴン
# 25: [[424.90384615384613, 80.75000000000001], [424.90384615384613, 20.750000000000007], [417.4038461538462, 20.750000000000007], [417.4038461538462, 80.75000000000001]],
# 26: [[134.1071428571429, 80.75000000000001], [134.1071428571429, 20.750000000000007], [126.60714285714288, 20.750000000000007], [126.60714285714288, 80.75000000000001]],
# 27: [[3.75, 80.75000000000001], [3.75, 20.750000000000007], [-3.75, 20.750000000000007], [-3.75, 80.75000000000001]],
# 28: [[948.65, 219.74999999999997], [948.65, 159.75], [941.15, 159.75], [941.15, 219.74999999999997]],
# 29: [[861.8249999999999, -20.750000000000007], [861.8249999999999, -80.75000000000001], [854.325, -80.75000000000001], [854.325, -20.750000000000007]],
# 30: [[730.5899999999999, -20.750000000000007], [730.5899999999999, -80.75000000000001], [723.09, -80.75000000000001], [723.09, -20.750000000000007]],
# 31: [[579.165, -20.750000000000007], [579.165, -80.75000000000001], [571.6650000000001, -80.75000000000001], [571.6650000000001, -20.750000000000007]],
# 32: [[276.315, -20.750000000000007], [276.315, -80.75000000000001], [268.815, -80.75000000000001], [268.815, -20.750000000000007]],
# 33: [[1174.75, -12.296511627906979], [1174.75, -19.79651162790698], [1114.75, -19.79651162790698], [1114.75, -12.296511627906979]],
# 34: [[1174.75, -265.203488372093], [1174.75, -272.703488372093], [1114.75, -272.703488372093], [1114.75, -265.203488372093]],
# 35: [[1035.7500000000002, -142.4], [1035.7500000000002, -149.9], [975.75, -149.9], [975.75, -142.4]],
# 36: [[1035.7500000000002, -356.25], [1035.7500000000002, -363.75], [975.75, -363.75], [975.75, -356.25]],

# 俺が作った1.5m間隔
25: [[1035.75, -350.75], [1035.75, -358.25], [975.7499999999999, -358.25], [975.7499999999999, -350.75]],
26: [[303.75, 80.74999999999999], [303.75, 20.749999999999996], [296.25, 20.749999999999996], [296.25, 80.74999999999999]],
27: [[603.75, -20.749999999999996], [603.75, -80.74999999999999], [596.25, -80.74999999999999], [596.25, -20.749999999999996]],
28: [[303.75, -20.749999999999996], [303.75, -80.74999999999999], [296.25, -80.74999999999999], [296.25, -20.749999999999996]],
29: [[753.75, -20.749999999999996], [753.75, -80.74999999999999], [746.25, -80.74999999999999], [746.25, -20.749999999999996]],
30: [[153.75, 80.74999999999999], [153.75, 20.749999999999996], [146.25, 20.749999999999996], [146.25, 80.74999999999999]],
31: [[153.75, -20.749999999999996], [153.75, -80.74999999999999], [146.25, -80.74999999999999], [146.25, -20.749999999999996]],
32: [[1177.5, -71.25], [1177.5, -78.75], [1117.5, -78.75], [1117.5, -71.25]],
33: [[1177.5, -221.25], [1177.5, -228.75], [1117.5, -228.75], [1117.5, -221.25]],
34: [[1035.75, -200.74999999999997], [1035.75, -208.25], [975.7499999999999, -208.25], [975.7499999999999, -200.74999999999997]],
35: [[903.75, -20.749999999999996], [903.75, -80.74999999999999], [896.25, -80.74999999999999], [896.25, -20.749999999999996]],
36: [[603.75, 80.74999999999999], [603.75, 20.749999999999996], [596.25, 20.749999999999996], [596.25, 80.74999999999999]],
37: [[753.75, 80.74999999999999], [753.75, 20.749999999999996], [746.25, 20.749999999999996], [746.25, 80.74999999999999]],
38: [[453.74999999999994, 80.74999999999999], [453.74999999999994, 20.749999999999996], [446.25000000000006, 20.749999999999996], [446.25000000000006, 80.74999999999999]],
39: [[453.74999999999994, -20.749999999999996], [453.74999999999994, -80.74999999999999], [446.25000000000006, -80.74999999999999], [446.25000000000006, -20.749999999999996]],


# 1.5m間隔で適当に配置したポリゴン（被覆問題ではない）
# 25: [[688.125, 80.75000000000001], [688.125, 20.750000000000007], [680.625, 20.750000000000007], [680.625, 80.75000000000001]],
# 26: [[459.99999999999994, 80.75000000000001], [459.99999999999994, 20.750000000000007], [452.50000000000006, 20.750000000000007], [452.50000000000006, 80.75000000000001]],
# 27: [[231.875, 80.75000000000001], [231.875, 20.750000000000007], [224.375, 20.750000000000007], [224.375, 80.75000000000001]],
# 28: [[3.75, 80.75000000000001], [3.75, 20.750000000000007], [-3.75, 20.750000000000007], [-3.75, 80.75000000000001]],
# 29: [[1139.25, 209.74999999999997], [1139.25, 149.74999999999997], [1131.75, 149.74999999999997], [1131.75, 209.74999999999997]],
# 30: [[1144.75, 108.74999999999999], [1144.75, 48.75], [1137.25, 48.75], [1137.25, 108.74999999999999]],
# 31: [[1174.75, -138.74999999999997], [1174.75, -146.25], [1114.75, -146.25], [1114.75, -138.74999999999997]],
# 32: [[1174.75, -356.24999999999994], [1174.75, -363.75], [1114.75, -363.75], [1114.75, -356.24999999999994]],
# 33: [[1035.7500000000002, -356.25], [1035.7500000000002, -363.75], [975.75, -363.75], [975.75, -356.25]],
# 34: [[811.35, -20.750000000000007], [811.35, -80.75000000000001], [803.8500000000001, -80.75000000000001], [803.8500000000001, -20.750000000000007]],
# 35: [[609.45, -20.750000000000007], [609.45, -80.75000000000001], [601.95, -80.75000000000001], [601.95, -20.750000000000007]],
# 36: [[407.55, -20.750000000000007], [407.55, -80.75000000000001], [400.05000000000007, -80.75000000000001], [400.05000000000007, -20.750000000000007]],
# 37: [[205.65000000000003, -20.750000000000007], [205.65000000000003, -80.75000000000001], [198.15, -80.75000000000001], [198.15, -20.750000000000007]],
# 38: [[3.75, -20.750000000000007], [3.75, -80.75000000000001], [-3.75, -80.75000000000001], [-3.75, -20.750000000000007]],
# 39: [[80.75000000000001, -357.24999999999994], [80.75000000000001, -364.74999999999994], [20.750000000000007, -364.74999999999994], [20.750000000000007, -357.24999999999994]],
# 40: [[168.25, -357.24999999999994], [168.25, -364.74999999999994], [108.24999999999999, -364.74999999999994], [108.24999999999999, -357.24999999999994]],
# 41: [[258.75, -357.24999999999994], [258.75, -364.74999999999994], [198.75, -364.74999999999994], [198.75, -357.24999999999994]],
# 42: [[359.74999999999994, -357.24999999999994], [359.74999999999994, -364.74999999999994], [299.75, -364.74999999999994], [299.75, -357.24999999999994]],
# 43: [[448.75, -357.24999999999994], [448.75, -364.74999999999994], [388.75, -364.74999999999994], [388.75, -357.24999999999994]],
# 44: [[551.25, -357.24999999999994], [551.25, -364.74999999999994], [491.25000000000006, -364.74999999999994], [491.25000000000006, -357.24999999999994]],
# 45: [[638.75, -357.24999999999994], [638.75, -364.74999999999994], [578.75, -364.74999999999994], [578.75, -357.24999999999994]],
# 46: [[742.0, -357.24999999999994], [742.0, -364.74999999999994], [682.0, -364.74999999999994], [682.0, -357.24999999999994]],
# 47: [[829.7500000000001, -357.24999999999994], [829.7500000000001, -364.74999999999994], [769.7500000000001, -364.74999999999994], [769.7500000000001, -357.24999999999994]],
# 48: [[964.2500000000002, -357.24999999999994], [964.2500000000002, -364.74999999999994], [904.25, -364.74999999999994], [904.25, -357.24999999999994]],

                # 25:[[200.0,129.5],[200.0,-129.5],[192.5,-129.5],[192.5,129.5]], #極端な白線を追加してみる
                # 25:[[200.0,129.5],[200.0,29.5],[192.5,29.5],[192.5,129.5]] #片側に100cmの白線を配置してみる
                # 25:[[200.0,79.5],[200.0,29.5],[192.5,29.5],[192.5,79.5]] #片側に50cmの白線を配置してみる



                }
# polygon_ros = {0:[[6000.0,54.5],[6000.0,47.0],[0.0,47.0],[0.0,54.5]],
#                1:[[6000.0,301.0],[6000.0,54.5],[5992.5,54.5],[5992.5, 301.0]],
#                2:[[6100.0,301.0],[6100.0,-361.0],[6092.5,-361.0],[6092.5,301.00]],
#                3:[[6000.0,-54.5],[6000.0,-361.0],[5992.5,-361.0],[5992.5, -54.5]],
#                4:[[6000.0,-47.0],[6000.0,-54.5],[0.0,-54.5],[0.0,-47.0]],}

# [, , , , [[502.15500000000003, -24.500000000000004], [502.15500000000003, -84.5], [487.15500000000003, -84.5], [487.15500000000003, -24.500000000000004]], [[360.825, -24.500000000000004], [360.825, -84.5], [345.82499999999993, -84.5], [345.82499999999993, -24.500000000000004]], [[1178.5, -69.24418604651162], [1178.5, -84.2441860465116], [1118.4999999999998, -84.2441860465116], [1118.4999999999998, -69.24418604651162]], [[1039.5000000000002, -199.75000000000003], [1039.5000000000002, -214.75000000000003], [979.5, -214.75000000000003], [979.5, -199.75000000000003]], [[1039.5000000000002, -342.3166666666667], [1039.5000000000002, -357.3166666666667], [979.5, -357.3166666666667], [979.5, -342.3166666666667]]]

# 出力先のcv座標系([x_cv,y_cv])
polygon_cv = {}
polygon_num = len(polygon_ros)
print(polygon_num)

# polygon_ros[key][何個目の座標か][xかyか]
for i in range(polygon_num): #ポリゴンが10個あるから
    coodinate = []
    for j in range(corner_num): # 4つ角だから 
        x_cv = x0_cv - polygon_ros[i][j][1] #x_cv = x0_cv - y_ros
        y_cv = y0_cv - polygon_ros[i][j][0] #y_cv = y0_cv - x_ros
        coodinate.append([x_cv,y_cv])
    polygon_cv[i] = coodinate

# 左上から右上、右下そして左下の座標の順番
for i in range(polygon_num):
    print("{}: {},".format(i, polygon_cv[i]))
